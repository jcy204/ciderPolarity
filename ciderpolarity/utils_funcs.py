try:
    from tqdm.auto import tqdm
except:
    from tqdm import tqdm
import csv

# from string import punctuation

punctuation = '!"#$%&\'()*+,-./:;<=>?@[\\]^_`{|}~!"#%&\'()*,-./:;?@[\\]_{}Â¡Â§Â«Â¶Â·Â»Â¿Í¾Î‡ÕšÕ›ÕœÕÕÕŸÖ‰ÖŠÖ¾×€×ƒ×†×³×´Ø‰ØŠØŒØØ›ØØŸÙªÙ«Ù¬Ù­Û”Ü€ÜÜ‚ÜƒÜ„Ü…Ü†Ü‡ÜˆÜ‰ÜŠÜ‹ÜŒÜß·ß¸ß¹à °à ±à ²à ³à ´à µà ¶à ·à ¸à ¹à ºà »à ¼à ½à ¾à¡à¥¤à¥¥à¥°à§½à©¶à«°à±·à²„à·´à¹à¹šà¹›à¼„à¼…à¼†à¼‡à¼ˆà¼‰à¼Šà¼‹à¼Œà¼à¼à¼à¼à¼‘à¼’à¼”à¼ºà¼»à¼¼à¼½à¾…à¿à¿‘à¿’à¿“à¿”à¿™à¿šáŠá‹áŒááááƒ»á á¡á¢á£á¤á¥á¦á§á¨á€á™®áš›ášœá›«á›¬á›­áœµáœ¶áŸ”áŸ•áŸ–áŸ˜áŸ™áŸšá €á á ‚á ƒá „á …á †á ‡á ˆá ‰á Šá¥„á¥…á¨á¨Ÿáª áª¡áª¢áª£áª¤áª¥áª¦áª¨áª©áªªáª«áª¬áª­á­šá­›á­œá­á­á­Ÿá­ á¯¼á¯½á¯¾á¯¿á°»á°¼á°½á°¾á°¿á±¾á±¿á³€á³á³‚á³ƒá³„á³…á³†á³‡á³“â€â€‘â€’â€“â€”â€•â€–â€—â€˜â€™â€šâ€›â€œâ€â€â€Ÿâ€ â€¡â€¢â€£â€¤â€¥â€¦â€§â€°â€±â€²â€³â€´â€µâ€¶â€·â€¸â€¹â€ºâ€»â€¼â€½â€¾â€¿â€ââ‚âƒâ…â†â‡âˆâ‰âŠâ‹âŒâââââ‘â“â”â•â–â—â˜â™âšâ›âœâââ½â¾â‚â‚âŒˆâŒ‰âŒŠâŒ‹âŒ©âŒªâ¨â©âªâ«â¬â­â®â¯â°â±â²â³â´âµâŸ…âŸ†âŸ¦âŸ§âŸ¨âŸ©âŸªâŸ«âŸ¬âŸ­âŸ®âŸ¯â¦ƒâ¦„â¦…â¦†â¦‡â¦ˆâ¦‰â¦Šâ¦‹â¦Œâ¦â¦â¦â¦â¦‘â¦’â¦“â¦”â¦•â¦–â¦—â¦˜â§˜â§™â§šâ§›â§¼â§½â³¹â³ºâ³»â³¼â³¾â³¿âµ°â¸€â¸â¸‚â¸ƒâ¸„â¸…â¸†â¸‡â¸ˆâ¸‰â¸Šâ¸‹â¸Œâ¸â¸â¸â¸â¸‘â¸’â¸“â¸”â¸•â¸–â¸—â¸˜â¸™â¸šâ¸›â¸œâ¸â¸â¸Ÿâ¸ â¸¡â¸¢â¸£â¸¤â¸¥â¸¦â¸§â¸¨â¸©â¸ªâ¸«â¸¬â¸­â¸®â¸°â¸±â¸²â¸³â¸´â¸µâ¸¶â¸·â¸¸â¸¹â¸ºâ¸»â¸¼â¸½â¸¾â¸¿â¹€â¹â¹‚â¹ƒâ¹„â¹…â¹†â¹‡â¹ˆâ¹‰â¹Šâ¹‹â¹Œâ¹â¹â¹â¹’ã€ã€‚ã€ƒã€ˆã€‰ã€Šã€‹ã€Œã€ã€ã€ã€ã€‘ã€”ã€•ã€–ã€—ã€˜ã€™ã€šã€›ã€œã€ã€ã€Ÿã€°ã€½ã‚ ãƒ»ê“¾ê“¿ê˜ê˜ê˜ê™³ê™¾ê›²ê›³ê›´ê›µê›¶ê›·ê¡´ê¡µê¡¶ê¡·ê£ê£ê£¸ê£¹ê£ºê£¼ê¤®ê¤¯ê¥Ÿê§ê§‚ê§ƒê§„ê§…ê§†ê§‡ê§ˆê§‰ê§Šê§‹ê§Œê§ê§ê§Ÿê©œê©ê©ê©Ÿê«ê«Ÿê«°ê«±ê¯«ï´¾ï´¿ï¸ï¸‘ï¸’ï¸“ï¸”ï¸•ï¸–ï¸—ï¸˜ï¸™ï¸°ï¸±ï¸²ï¸³ï¸´ï¸µï¸¶ï¸·ï¸¸ï¸¹ï¸ºï¸»ï¸¼ï¸½ï¸¾ï¸¿ï¹€ï¹ï¹‚ï¹ƒï¹„ï¹…ï¹†ï¹‡ï¹ˆï¹‰ï¹Šï¹‹ï¹Œï¹ï¹ï¹ï¹ï¹‘ï¹’ï¹”ï¹•ï¹–ï¹—ï¹˜ï¹™ï¹šï¹›ï¹œï¹ï¹ï¹Ÿï¹ ï¹¡ï¹£ï¹¨ï¹ªï¹«ï¼ï¼‚ï¼ƒï¼…ï¼†ï¼‡ï¼ˆï¼‰ï¼Šï¼Œï¼ï¼ï¼ï¼šï¼›ï¼Ÿï¼ ï¼»ï¼¼ï¼½ï¼¿ï½›ï½ï½Ÿï½ ï½¡ï½¢ï½£ï½¤ï½¥ğ„€ğ„ğ„‚ğŸğğ•¯ğ¡—ğ¤Ÿğ¤¿ğ©ğ©‘ğ©’ğ©“ğ©”ğ©•ğ©–ğ©—ğ©˜ğ©¿ğ«°ğ«±ğ«²ğ«³ğ«´ğ«µğ«¶ğ¬¹ğ¬ºğ¬»ğ¬¼ğ¬½ğ¬¾ğ¬¿ğ®™ğ®šğ®›ğ®œğº­ğ½•ğ½–ğ½—ğ½˜ğ½™ğ‘‡ğ‘ˆğ‘‰ğ‘Šğ‘‹ğ‘Œğ‘ğ‘‚»ğ‘‚¼ğ‘‚¾ğ‘‚¿ğ‘ƒ€ğ‘ƒğ‘…€ğ‘…ğ‘…‚ğ‘…ƒğ‘…´ğ‘…µğ‘‡…ğ‘‡†ğ‘‡‡ğ‘‡ˆğ‘‡ğ‘‡›ğ‘‡ğ‘‡ğ‘‡Ÿğ‘ˆ¸ğ‘ˆ¹ğ‘ˆºğ‘ˆ»ğ‘ˆ¼ğ‘ˆ½ğ‘Š©ğ‘‘‹ğ‘‘Œğ‘‘ğ‘‘ğ‘‘ğ‘‘šğ‘‘›ğ‘‘ğ‘“†ğ‘—ğ‘—‚ğ‘—ƒğ‘—„ğ‘—…ğ‘—†ğ‘—‡ğ‘—ˆğ‘—‰ğ‘—Šğ‘—‹ğ‘—Œğ‘—ğ‘—ğ‘—ğ‘—ğ‘—‘ğ‘—’ğ‘—“ğ‘—”ğ‘—•ğ‘—–ğ‘——ğ‘™ğ‘™‚ğ‘™ƒğ‘™ ğ‘™¡ğ‘™¢ğ‘™£ğ‘™¤ğ‘™¥ğ‘™¦ğ‘™§ğ‘™¨ğ‘™©ğ‘™ªğ‘™«ğ‘™¬ğ‘œ¼ğ‘œ½ğ‘œ¾ğ‘ »ğ‘¥„ğ‘¥…ğ‘¥†ğ‘§¢ğ‘¨¿ğ‘©€ğ‘©ğ‘©‚ğ‘©ƒğ‘©„ğ‘©…ğ‘©†ğ‘ªšğ‘ª›ğ‘ªœğ‘ªğ‘ªŸğ‘ª ğ‘ª¡ğ‘ª¢ğ‘±ğ‘±‚ğ‘±ƒğ‘±„ğ‘±…ğ‘±°ğ‘±±ğ‘»·ğ‘»¸ğ‘¿¿ğ’‘°ğ’‘±ğ’‘²ğ’‘³ğ’‘´ğ–©®ğ–©¯ğ–«µğ–¬·ğ–¬¸ğ–¬¹ğ–¬ºğ–¬»ğ–­„ğ–º—ğ–º˜ğ–º™ğ–ºšğ–¿¢ğ›²Ÿğª‡ğªˆğª‰ğªŠğª‹ğ¥ğ¥Ÿ'
translator = str.maketrans('', '', punctuation)


def default_clean_text(CDR, doc):
    "Input doc and return clean list of tokens"
    doc = doc.replace('\r', ' ').replace('\n', ' ')
    lower = doc.lower()  # all lower case
    nopunc = lower.translate(translator)  # remove punctuation
    words = nopunc.split()  # split into tokens
    if CDR.STOPWORDS:
        words = [
            w for w in words
            if w not in CDR.STOPWORDS and not w.isdigit()
        ]  # remove stopwords
    return words


def text_iterate(CDR, show=False, full=False):
    'Allows iteration over a list of text or a csc file'
    if isinstance(CDR.FILEINPUT, list):
        for row in tqdm(CDR.FILEINPUT, total=CDR.LINES,
                        disable=not show):
            yield row
    else:
        with open(CDR.FILEINPUT, encoding='utf-8') as f:
            reader = csv.reader(f)
            for row in tqdm(reader, total=CDR.LINES, disable=not show):
                if full:
                    yield row
                else:
                    yield ' ,'.join(row)


NEGATE = {"ain't",
 'aint',
 "aren't",
 'arent',
 "can't",
 'cannot',
 'cant',
 "couldn't",
 'couldnt',
 "daren't",
 'darent',
 'despite',
 "didn't",
 'didnt',
 "doesn't",
 'doesnt',
 "don't",
 'dont',
 "hadn't",
 'hadnt',
 "hasn't",
 'hasnt',
 "haven't",
 'havent',
 "isn't",
 'isnt',
 "mightn't",
 'mightnt',
 "mustn't",
 'mustnt',
 "needn't",
 'neednt',
 'neither',
 'never',
 'none',
 'nope',
 'nor',
 'not',
 'nothing',
 'nowhere',
 "oughtn't",
 'oughtnt',
 'rarely',
 'seldom',
 "shan't",
 'shant',
 "shouldn't",
 'shouldnt',
 'uh-uh',
 'uhuh',
 "wasn't",
 'wasnt',
 "weren't",
 'werent',
 'without',
 "won't",
 'wont',
 "wouldn't",
 'wouldnt'}